# Тестирование API модуля

В этом разделе представлены модульные тесты для API модулей проекта. Тесты разработаны с использованием Jest и axios-mock-adapter для мокирования HTTP-запросов.

## Структура тестов

Тесты организованы по структуре, соответствующей структуре исходных файлов:

```
tests/
├── unit/                    # Модульные тесты
│   ├── api/                 # Тесты API
│   │   ├── services/        # Тесты для сервисов API
│   │   │   ├── authService.spec.ts
│   │   │   ├── agentService.spec.ts
│   │   │   └── ...
│   │   ├── apiClient.spec.ts
│   │   ├── cacheManager.spec.ts
│   │   └── errorHandler.spec.ts
├── setup.ts                 # Настройка для тестов
└── README.md                # Этот файл
```

## Технологии

- Jest - основной фреймворк для тестирования
- ts-jest - поддержка TypeScript для Jest
- axios-mock-adapter - библиотека для мокирования axios запросов

## Как запустить тесты

### Установка зависимостей

Перед запуском тестов убедитесь, что все зависимости установлены:

```bash
npm install
```

### Запуск всех тестов

Для запуска всех тестов выполните:

```bash
npm test
```

### Запуск тестов в режиме наблюдения

Для запуска тестов в режиме наблюдения (тесты будут перезапускаться при изменении файлов):

```bash
npm run test:watch
```

### Генерация отчета о покрытии

Для генерации отчета о покрытии кода тестами:

```bash
npm run test:coverage
```

После выполнения этой команды будет создана папка `coverage` с отчетом о покрытии кода тестами.

## Написание новых тестов

При написании новых тестов следуйте этим рекомендациям:

1. Создавайте файлы тестов с расширением `.spec.ts`
2. Используйте моки для внешних зависимостей
3. Старайтесь изолировать тесты, чтобы они не зависели от внешнего состояния
4. Группируйте тесты логически с помощью `describe` и `it`
5. Используйте `beforeEach` и `afterEach` для настройки и очистки состояния

## Пример теста

```typescript
import { CacheManager } from '@/api/cacheManager';

describe('CacheManager', () => {
  beforeEach(() => {
    CacheManager.clear();
  });

  describe('get', () => {
    it('должен возвращать null для отсутствующего ключа', () => {
      expect(CacheManager.get('non-existent-key')).toBeNull();
    });
  });
});
``` 